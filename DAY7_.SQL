CREATE DATABASE DIGITAL_MKT_ANALYSIS;

USE DIGITAL_MKT_ANALYSIS;

SELECT * FROM MARKETING;

--CHECKING FOR MISSING VALUES

SELECT * FROM MARKETING 
WHERE AGE IS NULL;

SELECT * FROM MARKETING 
WHERE CAMPAIGNCHANNEL IS NULL;

--GET THE COUNT OF ROWS HAVING NULL VALUE IN A COLUMN

SELECT 
SUM(CASE WHEN AGE IS NULL THEN 1 ELSE 0
END) AS AGENULL
FROM MARKETING;

--CHECK MISSING VALUES FOR ALL COLUMNS
SELECT 
SUM(CASE WHEN AGE IS NULL THEN 1 ELSE 0 END) AS AGENULL,
SUM(CASE WHEN GENDER IS NULL THEN 1 ELSE 0 END) AS GENDERNULL,
SUM(CASE WHEN INCOME IS NULL THEN 1 ELSE 0 END) AS INCOMENULL,
SUM(CASE WHEN SOCIALSHARES IS NULL THEN 1 ELSE 0 END) AS SOCIALSHARESNULL,
SUM(CASE WHEN CAMPAIGNTYPE IS NULL THEN 1 ELSE 0 END) AS CAMPAIGNNULL
FROM MARKETING;

--EDA EXPLORATORY DATA ANALYSIS CAN BE PERFORMED ONCE DATA IS CLEANED USING ABOVE STEPS
--CAMPAIGN CHANNEL

SELECT DISTINCT (CAMPAIGNCHANNEL) FROM MARKETING;

/*
PPC- Pay per Click
Referral
Email
SEO-Search Engine Optimization
Social Media
*/

SELECT DISTINCT CAMPAIGNTYPE FROM MARKETING;
/*
Consideration
Awareness
Conversion
Retention
*/

SELECT DISTINCT ADVERTISINGPLATFORM FROM MARKETING; ---IS CONFIDENTIAL
SELECT DISTINCT ADVERTISINGTOOL FROM MARKETING;--- IS CONFIDENTIAL

--DROP COLUMNS WHICH ARE NOT NEEDED IN OUR ANALYSIS
--Dropping a column is manipulation of data/table so use ALTER


ALTER TABLE MARKETING
DROP COLUMN ADVERTISINGTOOL,ADVERTISINGPLATFORM;

--COUNT NUMBER OF ROWS FROM MARKETING

SELECT COUNT(*) AS CNT_ROWS FROM MARKETING;
/*8000 ROWS*/


--CONVERSION COLUMN

SELECT DISTINCT CONVERSION FROM MARKETING;

